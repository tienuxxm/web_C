{"ast":null,"code":"import _regeneratorRuntime from\"D:/Javascript/React/order-purchasing/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/Javascript/React/order-purchasing/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"D:/Javascript/React/order-purchasing/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"D:/Javascript/React/order-purchasing/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"D:/Javascript/React/order-purchasing/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,memo,useRef}from'react';import{useNavigate}from'react-router-dom';import{postApi}from'../../api';import{Toast}from'primereact/toast';import{InputText}from\"primereact/inputtext\";import{Password}from'primereact/password';import Spinner from'../../components/Spinner';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Login(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),inputs=_useState4[0],setInputs=_useState4[1];var navigate=useNavigate();var toast=useRef(null);var handleChange=function handleChange(event){var name=event.target.name;var value=event.target.value;setInputs(function(values){return _objectSpread(_objectSpread({},values),{},_defineProperty({},name,value));});};var showError=function showError(){toast.current.show({severity:'error',summary:'Error',detail:'Đăng nhập thất bại!',life:3000});};var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var formData,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();_context.prev=1;setLoading(true);formData=new FormData();formData.append('email',inputs.email);formData.append('password',inputs.password);_context.next=8;return postApi(\"auth/login\",formData);case 8:res=_context.sent;localStorage.setItem('access_token',JSON.stringify(res.access_token));localStorage.setItem('role',JSON.stringify(res.user[0].role_name));localStorage.setItem('department',JSON.stringify(res.user[0].department_name));localStorage.setItem('name',JSON.stringify(res.user[0].name));setLoading(false);navigate(\"/purchasing/report-statistics\");navigate(0);_context.next=21;break;case 18:_context.prev=18;_context.t0=_context[\"catch\"](1);showError();case 21:case\"end\":return _context.stop();}},_callee,null,[[1,18]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"login\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"login-box\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"logo\",children:/*#__PURE__*/_jsx(\"img\",{src:\"img/logoBitex.png\",alt:\"Logo\"})}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"span\",{className:\"p-float-label\",children:[/*#__PURE__*/_jsx(InputText,{id:\"email\",type:\"email\",onChange:handleChange,name:\"email\",value:inputs.email||\"\",required:true}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",children:\"T\\xEAn \\u0111\\u0103ng nh\\u1EADp\"})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"p-float-label\",children:[/*#__PURE__*/_jsx(Password,{id:\"password\",type:\"password\",onChange:handleChange,name:\"password\",value:inputs.password||\"\",toggleMask:true,feedback:false,required:true}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"M\\u1EADt kh\\u1EA9u\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"\\u0110\\u0103ng nh\\u1EADp\"})]}),loading&&/*#__PURE__*/_jsx(Spinner,{}),/*#__PURE__*/_jsx(Toast,{ref:toast})]})});}export default/*#__PURE__*/memo(Login);","map":{"version":3,"names":["useState","memo","useRef","useNavigate","postApi","Toast","InputText","Password","Spinner","Login","loading","setLoading","inputs","setInputs","navigate","toast","handleChange","event","name","target","value","values","showError","current","show","severity","summary","detail","life","handleSubmit","preventDefault","formData","FormData","append","email","password","res","localStorage","setItem","JSON","stringify","access_token","user","role_name","department_name"],"sources":["D:/Javascript/React/order-purchasing/src/pages/Login/index.js"],"sourcesContent":["import { useState, memo, useRef } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { postApi } from '../../api';\r\nimport { Toast } from 'primereact/toast';\r\nimport { InputText } from \"primereact/inputtext\";\r\nimport { Password } from 'primereact/password';\r\nimport Spinner from '../../components/Spinner';\r\n\r\nfunction Login() {\r\n  const [loading, setLoading] = useState(false);\r\n  const [inputs, setInputs] = useState({});\r\n  const navigate = useNavigate();\r\n  const toast = useRef(null);\r\n\r\n  const handleChange = (event) => {\r\n    const name = event.target.name;\r\n    const value = event.target.value;\r\n    setInputs(values => ({...values, [name]: value}));\r\n  }\r\n\r\n  const showError = () => {\r\n    toast.current.show({severity:'error', summary: 'Error', detail:'Đăng nhập thất bại!', life: 3000});\r\n  }\r\n  \r\n  const handleSubmit = async(event) => {\r\n    event.preventDefault();\r\n    \r\n    try {\r\n      setLoading(true);\r\n      let formData = new FormData(); \r\n      formData.append('email', inputs.email);\r\n      formData.append('password', inputs.password);\r\n\r\n      const res = await postApi(\"auth/login\", formData);\r\n      localStorage.setItem('access_token', JSON.stringify(res.access_token));\r\n      localStorage.setItem('role', JSON.stringify(res.user[0].role_name));\r\n      localStorage.setItem('department', JSON.stringify(res.user[0].department_name));\r\n      localStorage.setItem('name', JSON.stringify(res.user[0].name));\r\n      setLoading(false);\r\n      navigate(\"/purchasing/report-statistics\");\r\n      navigate(0);\r\n    } catch (error) {\r\n      showError();\r\n    }\r\n  }\r\n\r\n  return ( \r\n    <div className=\"login\">\r\n      <div className=\"login-box\">\r\n        <div className=\"logo\"> \r\n          <img src=\"img/logoBitex.png\" alt=\"Logo\"/>\r\n        </div>\r\n        <form onSubmit={handleSubmit}>\r\n          <span className=\"p-float-label\">\r\n                <InputText id=\"email\" type=\"email\" onChange={handleChange} name=\"email\" value={inputs.email || \"\"}  required />\r\n                <label htmlFor=\"email\">Tên đăng nhập</label>\r\n          </span>\r\n          <span className=\"p-float-label\">\r\n              <Password  id=\"password\" type=\"password\" onChange={handleChange} name=\"password\" value={inputs.password || \"\"} toggleMask  feedback={false} required />\r\n              <label htmlFor=\"password\">Mật khẩu</label>\r\n          </span>\r\n          <input type=\"submit\" value=\"Đăng nhập\"  />\r\n        </form>\r\n        {loading && <Spinner />}\r\n        <Toast ref={toast} />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default memo(Login);\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}